<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.image.ImageView?>

<BorderPane xmlns:fx="http://javafx.com/fxml" fx:controller="com.sajid._207017_chashi_bhai.controllers.CropFeedController" styleClass="root" minHeight="700" minWidth="1024">
    
    <!-- Top Navigation -->
    <top>
        <VBox>
            <HBox alignment="CENTER_LEFT" spacing="20" styleClass="nav-bar">
                <padding>
                    <Insets top="15" bottom="15" left="20" right="20"/>
                </padding>
                <Button text="â†" styleClass="back-button" fx:id="btnBack" onAction="#onBack"/>
                <Label text="à¦¸à¦•à¦² à¦«à¦¸à¦² / Browse Crops" styleClass="page-title"/>
                <Region HBox.hgrow="ALWAYS"/>
                <TextField fx:id="txtQuickSearch" promptText="à¦–à§à¦à¦œà§à¦¨..." styleClass="quick-search" prefWidth="250"/>
            </HBox>
            
            <!-- Filter Bar -->
            <HBox spacing="15" alignment="CENTER_LEFT" styleClass="filter-bar">
                <padding>
                    <Insets top="12" bottom="12" left="20" right="20"/>
                </padding>
                <Label text="à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦°:" styleClass="filter-label"/>
                
                <ComboBox fx:id="cbFilterCropType" promptText="à¦«à¦¸à¦²à§‡à¦° à¦§à¦°à¦¨" styleClass="filter-combo" prefWidth="180">
                    <items>
                        <FXCollections fx:factory="observableArrayList">
                            <String fx:value="à¦¸à¦¬ à¦§à¦°à¦¨ (All Types)"/>
                            <String fx:value="à¦¶à¦¸à§à¦¯ (Grains)"/>
                            <String fx:value="à¦¸à¦¬à¦œà¦¿ (Vegetables)"/>
                            <String fx:value="à¦«à¦² (Fruits)"/>
                            <String fx:value="à¦®à¦¸à¦²à¦¾ (Spices)"/>
                        </FXCollections>
                    </items>
                </ComboBox>
                
                <ComboBox fx:id="cbFilterDistrict" promptText="à¦œà§‡à¦²à¦¾" styleClass="filter-combo" prefWidth="180">
                    <items>
                        <FXCollections fx:factory="observableArrayList">
                            <String fx:value="à¦¸à¦¬ à¦œà§‡à¦²à¦¾ (All Districts)"/>
                            <String fx:value="à¦¢à¦¾à¦•à¦¾ (Dhaka)"/>
                            <String fx:value="à¦šà¦Ÿà§à¦Ÿà¦—à§à¦°à¦¾à¦® (Chattogram)"/>
                            <String fx:value="à¦°à¦¾à¦œà¦¶à¦¾à¦¹à§€ (Rajshahi)"/>
                            <String fx:value="à¦–à§à¦²à¦¨à¦¾ (Khulna)"/>
                        </FXCollections>
                    </items>
                </ComboBox>
                
                <Label text="à¦®à§‚à¦²à§à¦¯:" styleClass="filter-label"/>
                <Slider fx:id="sliderPriceMin" min="0" max="1000" value="0" prefWidth="120" styleClass="price-slider"/>
                <Label fx:id="lblPriceRange" text="à§³ 0 - à§³ 1000" styleClass="filter-label"/>
                
                <CheckBox fx:id="chkVerifiedOnly" text="âœ“ à¦¶à§à¦§à§ à¦¯à¦¾à¦šà¦¾à¦‡à¦•à§ƒà¦¤" styleClass="filter-checkbox"/>
                
                <Button fx:id="btnApplyFilter" text="à¦ªà§à¦°à¦¯à¦¼à§‹à¦— à¦•à¦°à§à¦¨" styleClass="button-primary" onAction="#onApplyFilter"/>
                <Button fx:id="btnResetFilter" text="à¦°à¦¿à¦¸à§‡à¦Ÿ" styleClass="button-secondary" onAction="#onResetFilter"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="scroll-pane">
            <VBox spacing="15" fx:id="vboxCropFeed">
                <padding>
                    <Insets top="20" bottom="20" left="30" right="30"/>
                </padding>
                
                <!-- Crop Card 1 -->
                <HBox spacing="25" styleClass="crop-feed-card" alignment="CENTER_LEFT">
                    <padding>
                        <Insets top="20" bottom="20" left="25" right="25"/>
                    </padding>
                    
                    <!-- Crop Image -->
                    <ImageView fitWidth="140" fitHeight="140" preserveRatio="true" styleClass="crop-feed-image"/>
                    
                    <!-- Crop Info -->
                    <VBox spacing="10" HBox.hgrow="ALWAYS">
                        <?xml version="1.0" encoding="UTF-8"?>

                        <?import javafx.collections.FXCollections?>
                        <?import javafx.geometry.Insets?>
                        <?import javafx.scene.control.*?>
                        <?import javafx.scene.layout.*?>
                        <?import javafx.scene.image.ImageView?>

                        <BorderPane xmlns:fx="http://javafx.com/fxml" fx:controller="com.sajid._207017_chashi_bhai.controllers.CropFeedController" styleClass="root" minHeight="700" minWidth="1024">
    
                            <!-- Top Navigation -->
                            <top>
                                <VBox spacing="12">
                                    <!-- Primary top bar -->
                                    <HBox alignment="CENTER_LEFT" spacing="16" styleClass="nav-bar">
                                        <padding>
                                            <Insets top="12" bottom="12" left="16" right="16"/>
                                        </padding>
                                        <Button text="â†" styleClass="back-button" fx:id="btnBack" onAction="#onBack"/>
                                        <Label fx:id="lblTitle" text="à¦†à¦œà¦•à§‡à¦° à¦‰à¦ªà¦²à¦¬à§à¦§ à¦«à¦¸à¦²à¦¸à¦®à§‚à¦¹" styleClass="page-title"/>
                                        <Region HBox.hgrow="ALWAYS"/>
                                        <TextField fx:id="txtSearch" promptText="à¦«à¦¸à¦² à¦–à§à¦à¦œà§à¦¨..." styleClass="search-input" prefWidth="320" onKeyReleased="#onSearchKeyUp"/>
                                        <Button fx:id="btnToggleFilter" text="âš™ï¸ à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦°" styleClass="button-secondary" onAction="#onToggleFilter"/>
                                    </HBox>

                                    <!-- Optional farmer-only quick section header (rendered by controller) -->
                                    <HBox fx:id="hboxMyCropsHeader" alignment="CENTER_LEFT" spacing="8" visible="false">
                                        <padding>
                                            <Insets left="20" right="20"/>
                                        </padding>
                                        <Label text="à¦†à¦®à¦¾à¦° à¦«à¦¸à¦²à¦¸à¦®à§‚à¦¹" styleClass="section-title"/>
                                    </HBox>
                                </VBox>
                            </top>

                            <!-- Center: progress + scroll list -->
                            <center>
                                <VBox spacing="10">
                                    <padding>
                                        <Insets top="10" bottom="10" left="16" right="16"/>
                                    </padding>
                                    <ProgressIndicator fx:id="progressIndicator" visible="false" maxWidth="60" maxHeight="60"/>
            
                                    <!-- Farmer-only highlights grid (shown by controller when role=farmer) -->
                                    <GridPane fx:id="myCropsGrid" hgap="12" vgap="12" visible="false">
                                        <columnConstraints>
                                            <ColumnConstraints percentWidth="33"/>
                                            <ColumnConstraints percentWidth="33"/>
                                            <ColumnConstraints percentWidth="33"/>
                                        </columnConstraints>
                                    </GridPane>

                                    <!-- Main feed -->
                                    <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="scroll-pane">
                                        <VBox fx:id="vboxCrops" spacing="12">
                                            <padding>
                                                <Insets top="10" bottom="20"/>
                                            </padding>
                                        </VBox>
                                    </ScrollPane>
                                </VBox>
                            </center>

                            <!-- Right: filter pane (toggle visibility) -->
                            <right>
                                <VBox fx:id="filterPane" spacing="12" visible="false" styleClass="filter-pane">
                                    <padding>
                                        <Insets top="16" bottom="16" left="16" right="16"/>
                                    </padding>
                                    <Label text="à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦°" styleClass="section-title"/>
            
                                    <Label text="à¦•à§à¦¯à¦¾à¦Ÿà¦¾à¦—à¦°à¦¿" styleClass="filter-label"/>
                                    <ComboBox fx:id="cmbCategory" promptText="à¦•à§à¦¯à¦¾à¦Ÿà¦¾à¦—à¦°à¦¿ à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨" styleClass="filter-combo">
                                        <items>
                                            <FXCollections fx:factory="observableArrayList">
                                                <String fx:value="à¦¸à¦¬"/>
                                                <String fx:value="à¦¶à¦¸à§à¦¯"/>
                                                <String fx:value="à¦¸à¦¬à¦œà¦¿"/>
                                                <String fx:value="à¦«à¦²"/>
                                                <String fx:value="à¦®à¦¸à¦²à¦¾"/>
                                            </FXCollections>
                                        </items>
                                    </ComboBox>

                                    <Label text="à¦œà§‡à¦²à¦¾" styleClass="filter-label"/>
                                    <ComboBox fx:id="cmbDistrict" promptText="à¦œà§‡à¦²à¦¾ à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨" styleClass="filter-combo">
                                        <items>
                                            <FXCollections fx:factory="observableArrayList">
                                                <String fx:value="à¦¸à¦¬"/>
                                                <String fx:value="à¦¢à¦¾à¦•à¦¾"/>
                                                <String fx:value="à¦šà¦Ÿà§à¦Ÿà¦—à§à¦°à¦¾à¦®"/>
                                                <String fx:value="à¦°à¦¾à¦œà¦¶à¦¾à¦¹à§€"/>
                                                <String fx:value="à¦–à§à¦²à¦¨à¦¾"/>
                                                <String fx:value="à¦¬à¦°à¦¿à¦¶à¦¾à¦²"/>
                                                <String fx:value="à¦¸à¦¿à¦²à§‡à¦Ÿ"/>
                                                <String fx:value="à¦°à¦‚à¦ªà§à¦°"/>
                                                <String fx:value="à¦®à¦¯à¦¼à¦®à¦¨à¦¸à¦¿à¦‚à¦¹"/>
                                            </FXCollections>
                                        </items>
                                    </ComboBox>

                                    <Label text="à¦®à§‚à¦²à§à¦¯ à¦¸à§€à¦®à¦¾" styleClass="filter-label"/>
                                    <HBox spacing="8">
                                        <TextField fx:id="tfPriceMin" promptText="à¦¸à¦°à§à¦¬à¦¨à¦¿à¦®à§à¦¨" prefWidth="90"/>
                                        <Label text="â€”"/>
                                        <TextField fx:id="tfPriceMax" promptText="à¦¸à¦°à§à¦¬à§‹à¦šà§à¦š" prefWidth="90"/>
                                    </HBox>

                                    <CheckBox fx:id="chkVerifiedOnly" text="âœ“ à¦¶à§à¦§à§ à¦¯à¦¾à¦šà¦¾à¦‡à¦•à§ƒà¦¤ à¦•à§ƒà¦·à¦•" styleClass="filter-checkbox"/>

                                    <HBox spacing="10">
                                        <Button fx:id="btnApplyFilter" text="à¦ªà§à¦°à¦¯à¦¼à§‹à¦—" styleClass="button-primary" onAction="#onApplyFilter"/>
                                        <Button fx:id="btnClearFilter" text="à¦°à¦¿à¦¸à§‡à¦Ÿ" styleClass="button-secondary" onAction="#onClearFilter"/>
                                    </HBox>
                                </VBox>
                            </right>

                            <!-- Bottom: total count -->
                            <bottom>
                                <HBox alignment="CENTER_RIGHT">
                                    <padding>
                                        <Insets top="8" bottom="8" left="16" right="16"/>
                                    </padding>
                                    <Region HBox.hgrow="ALWAYS"/>
                                    <Label fx:id="lblTotalCount" text="à¦®à§‹à¦Ÿ à¦«à¦¸à¦²: 0à¦Ÿà¦¿" styleClass="footer-text"/>
                                </HBox>
                            </bottom>
                        </BorderPane>
                    </VBox>
                </HBox>

                <!-- Empty State -->
                <VBox alignment="CENTER" spacing="20" fx:id="vboxEmptyState" visible="false">
                    <padding>
                        <Insets top="60" bottom="60"/>
                    </padding>
                    <Label text="ðŸ”" styleClass="empty-icon"/>
                    <Label text="à¦•à§‹à¦¨à§‹ à¦«à¦¸à¦² à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿" styleClass="empty-text"/>
                    <Label text="à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦° à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦•à¦°à§‡ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨" styleClass="empty-subtext"/>
                </VBox>

            </VBox>
        </ScrollPane>
    </center>
    
</BorderPane>
